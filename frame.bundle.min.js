!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("data-capsule",[],t):"object"==typeof exports?exports["data-capsule"]=t():e["data-capsule"]=t()}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://static.parastorage.com/services/data-capsule/1.419.0/",n(n.s=46)}([function(e,t,n){"use strict";n.d(t,"i",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return f})),n.d(t,"g",(function(){return d})),n.d(t,"c",(function(){return l}));var r={NOT_FOUND:new Error("Key was not found in capsule"),SERVER_ERROR:new Error("Failed to perform operarion on server"),LOCAL_STORAGE_UNSUPPORTED:new Error("LocalStorage is not supported")};function o(e){return Object.keys(r).map((function(e){return r[e]})).find((function(t){return t.message===e}))||new Error(e)}var i="|",a="#",s="capsule",u=r.NOT_FOUND,c=2e3,f=8e3,d=r.SERVER_ERROR,l=r.LOCAL_STORAGE_UNSUPPORTED},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){var t=this;["setItem","getItem","removeItem","getAllItems"].forEach((function(n){if(t[n]===e.prototype[n])throw new Error("BaseStorage method ["+n+"] must be overriden!")}))}var t=e.prototype;return t.extendScope=function(e){return e},t.setItem=function(e,t,n){throw n},t.getItem=function(e,t){throw t},t.removeItem=function(e,t){throw t},t.getAllItems=function(e){throw e},e.verify=function(t){if(t instanceof e)return t;throw new Error("This class must extend BaseStorage!")},e}()},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);var o=function(e){var t,n;function o(t){var n,o=t.strategy,i=t.namespace,a=t.scope;return(n=e.call(this)||this).storageStrategy=r.a.verify(o),n._options={namespace:i,scope:a},n}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=o.prototype;return i._buildValidateOptions=function(e,t){return(t=Object.assign({},e,t)).scope=this.storageStrategy.extendScope(t.scope),function(e){if(!e.namespace)throw new Error("namespace is required");if("string"!=typeof e.namespace)throw new Error("namespace should be a string")}(t),t},i.setItem=function(e,t,n){return n=this._buildValidateOptions(this._options,n),this.storageStrategy.setItem(e,t,n)},i.getItem=function(e,t){return t=this._buildValidateOptions(this._options,t),this.storageStrategy.getItem(e,t)},i.removeItem=function(e,t){return t=this._buildValidateOptions(this._options,t),this.storageStrategy.removeItem(e,t)},i.getAllItems=function(e){return e=this._buildValidateOptions(this._options,e),this.storageStrategy.getAllItems(e)},o}(r.a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseConnectionMessage=t.constructConnectionMessage=t.parseChannelMessage=t.constructChannelMessage=void 0;var r=n(7);t.constructChannelMessage=function(e,t){return t?t+r.messageDelimiter+e:e},t.parseChannelMessage=function(e){var t=e.indexOf(r.messageDelimiter);return-1===t?{id:null,payload:e}:{id:e.slice(0,t),payload:e.slice(t+1)}},t.constructConnectionMessage=function(e){return r.connectionRequestMsg+r.messageDelimiter+e},t.parseConnectionMessage=function(e){var t=e.indexOf(r.messageDelimiter);if(-1===t||e.slice(0,t)!==r.connectionRequestMsg)throw new Error("Invalid connection message");return e.slice(t+1)}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r=e.split(t,n);if(r.length===n){var o=0;o="string"==typeof t?r.join(t).length:r.reduce((function(r,o,i){var a=0;return i+1<n&&(a=e.slice(r).match(t).shift().length),r+o.length+a}),0),r[n-1]+=e.slice(o)}return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.connectionRequestMsg="req_con",t.connectionSuccessMsg="connection_success",t.messageDelimiter="|",t.deafultConnectionMaxTimeout=200,t.deafultMessageMaxTimeout=5e3},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(6),o=n.n(r),i=n(11),a=n.n(i),s=n(1),u=n(0);var c=function(e){var t,n;function r(t,n,r,o){var i;void 0===o&&(o={}),(i=e.call(this)||this).target=t,i.origin=n,i.token=r,i.channel=void 0,i.opts=o;var a=i.opts,s=a.connectionMaxTimeout,c=void 0===s?u.a:s,f=a.messageMaxTimeout,d=void 0===f?u.d:f;return i.connectionMaxTimeout=c,i.messageMaxTimeout=d,i}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.getChannel=function(){var e=this;return this.channel?Promise.resolve(this.channel):a()("data-capsule",{target:this.target,origin:this.origin,connectionMaxTimeout:this.connectionMaxTimeout,messageMaxTimeout:this.messageMaxTimeout}).then((function(t){return e.channel=t,t}))},i.sendCommand=function(e,t){var n=this,r={data:t};return this.getChannel().then((function(t){return t([n.token,e,JSON.stringify(r)].join("|")).then((function(e){var t=o()(e.data,"|",2),n=t[0],r=t[1];if("reject"===n)throw Object(u.i)(r);return JSON.parse(r).data}))}))},i.setItem=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.sendCommand("setItem",t)},i.getItem=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.sendCommand("getItem",t)},i.removeItem=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.sendCommand("removeItem",t)},i.getAllItems=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.sendCommand("getAllItems",t)},r}(s.a)},,function(e,t,n){e.exports=n(15)},,,,function(e,t,n){"use strict";var r,o=n(7),i=n(5),a=n(16),s=(r=a)&&r.__esModule?r:{default:r};e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.targetOrigin,r=void 0===n?"*":n,a=t.connectionMaxTimeout,u=void 0===a?o.deafultConnectionMaxTimeout:a,c=t.messageMaxTimeout,f=void 0===c?o.deafultMessageMaxTimeout:c;return new Promise((function(t,n){setTimeout((function(){n(new Error("max timeout of "+u+"ms exceeded"))}),u);var a=new window.MessageChannel;a.port1.onmessage=function(e){if(e.data===o.connectionSuccessMsg)return t((0,s.default)(a.port1,{messageMaxTimeout:f}));n(new Error("connection could not establise"))};var c=(0,i.constructConnectionMessage)(e);window.parent.postMessage(c,r,[a.port2])}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.messageMaxTimeout,r={};return e.onmessage=function(e){var t=(0,o.parseChannelMessage)(e.data),n=t.id,i=t.payload;if(r[n]){var a={data:i,origin:e.origin,lastEventId:e.lastEventId,source:e.source,ports:e.ports};r[n](a)}},function(t,i){return new Promise((function(s,u){setTimeout((function(){u(new Error("max timeout of "+n+"ms exceeded"))}),n);var c=(0,a.default)(),f=(0,o.constructChannelMessage)(t,c);return r[c]=s,e.postMessage(f,i)}))}};var r,o=n(5),i=n(17),a=(r=i)&&r.__esModule?r:{default:r}},function(e,t,n){var r=n(18),o=n(19);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[i+s]=a[s];return t||o(a)}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(47);"undefined"!=typeof window&&(window.DataCapsuleTools=r),e.exports=r},function(e,t,n){"use strict";n.r(t);var r=n(9);n.d(t,"FrameStorageStrategy",(function(){return r.a}));var o=n(0);n.d(t,"NOT_FOUND",(function(){return o.e}));var i=n(1);n.d(t,"BaseStorage",(function(){return i.a}));var a=n(4);n.d(t,"DataCapsule",(function(){return a.a}))}])}));
//# sourceMappingURL=frame.bundle.min.js.map